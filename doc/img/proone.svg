<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="553px" preserveAspectRatio="none" style="width:1006px;height:553px;background:#FFFFFF;" version="1.1" viewBox="0 0 1006 553" width="1006px" zoomAndPan="magnify"><defs><filter height="300%" id="fyc6o7633s18l" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[9c764811e359eb79ee69534d40b7ac6f]
cluster prne_i--><polygon fill="#FFFFFF" filter="url(#fyc6o7633s18l)" points="16,115,151,115,158,137.2969,755,137.2969,755,437,16,437,16,115" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="16" x2="158" y1="137.2969" y2="137.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="129" x="20" y="129.9951">Proone Instance</text><!--MD5=[8ef77d0fb31372a32407c76568343a29]
cluster Heartbeat--><rect fill="#FFFFFF" filter="url(#fyc6o7633s18l)" height="109" style="stroke:#000000;stroke-width:1.5;" width="340" x="391" y="158"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.5;" width="15" x="711" y="163"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.5;" width="4" x="709" y="165"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.5;" width="4" x="709" y="169"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="522" y="183.9951">Heartbeat</text><!--MD5=[941875f88b4f76c76a8e027d9b948182]
cluster bne_pool--><rect fill="#FFFFFF" filter="url(#fyc6o7633s18l)" height="97" style="stroke:#000000;stroke-width:1.5;" width="132" x="244" y="316"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1.5;" width="15" x="356" y="321"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.5;" width="4" x="354" y="323"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1.5;" width="4" x="354" y="327"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="69" x="275.5" y="341.9951">BNE Pool</text><!--MD5=[7c9481bd1a7d8f3a175620bb8a866d7c]
cluster Public DOT Nameservers--><path d="M789.4788,326.066 C792.5835,320.581 797.1448,319.113 801.4717,324.7479 C805.1574,317.5779 811.3199,317.9515 816.0227,323.5927 C819.8738,315.4873 825.4728,316.2472 830.3649,322.5569 C835.4778,316.2666 839.3654,317.5551 842.9303,324.0752 C846.9392,316.7184 853.211,315.8564 859.0442,321.8777 C863.0998,317.0927 868.4942,317.0172 871.3515,323.2199 C874.6091,315.4272 881.2788,314.3936 886.9608,320.4965 C891.2953,314.8373 896.8201,315.4889 899.9203,321.8295 C903.8754,316.1393 910.1015,317.562 912.918,323.1426 C917.5685,317.1126 924.7685,317.2818 928.5642,324.1774 C932.3141,317.5108 936.3498,316.8992 941.4552,322.7855 C946.8232,315.135 954.1255,317.3285 956.7761,325.4287 C960.9292,318.2515 965.0918,317.4604 970.6342,324.0279 C974.8258,318.1521 980.4237,319.9434 982.3412,326.2189 C990.084,328.523 993.3402,332.4456 988.1149,340.1315 C996.066,343.1292 995.9477,348.4513 990.1149,353.5096 C997.2278,355.1334 999.3584,358.6679 995.0563,365.1412 C999.7715,370.144 998.2696,377.1261 991.3948,379.0856 C996.2033,385.2041 995.235,392.8219 986.1351,394.0527 C990.666,398.2893 991.0733,403.0828 984.3221,405.5384 C982.2541,413.8205 974.9515,414.0364 970.118,408.3507 C966.6894,414.2038 960.5565,414.7882 956.4938,409.0992 C953.3744,416.8236 947.5376,416.9745 942.4723,411.1065 C939.0933,419.2426 931.7257,418.9254 926.6304,413.0464 C922.8771,418.3817 918.1533,419.6413 914.0541,413.4229 C909.4096,421.5453 903.5402,420.1962 898.8025,413.5189 C896.2541,420.4163 891.2766,421.7355 885.9435,416.4608 C880.6017,422.292 875.6817,423.6638 871.2087,415.5431 C866.8991,420.9083 860.6333,419.3712 858.0841,413.4888 C854.1124,419.9176 847.5893,418.8992 844.1159,412.9276 C838.4901,418.8163 834.6477,417.3757 830.9149,410.9056 C826.9906,417.5705 820.3328,416.9785 816.8549,410.4306 C811.8895,417.9727 804.544,416.839 801.2681,408.7463 C797.5646,414.0337 791.5576,413.0544 788.9869,407.4671 C781.5578,403.5098 780.514,397.7297 786.6794,391.7736 C780.1051,389.7407 779.6843,383.9186 784.7338,379.9698 C777.6222,376.7943 777.0792,372.2109 781.7727,366.4499 C776.4987,360.1531 777.9257,354.8792 785.8486,352.4149 C778.7046,347.3351 779.1299,343.0854 786.5483,338.7515 C780.8945,333.3761 782.4069,328.5016 789.4788,326.066 " fill="#FFFFFF" filter="url(#fyc6o7633s18l)" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="195" x="787" y="341.9951">Public DOT Nameservers</text><!--MD5=[42d63f371a1b2b55232c669850b6835e]
entity Main Thread--><rect fill="#FEFECE" filter="url(#fyc6o7633s18l)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="125" x="247.5" y="199"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="352.5" y="204"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="350.5" y="206"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="350.5" y="210"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="262.5" y="231.9951">Main Thread</text><!--MD5=[162bad913f27a966d78603a1f88c43c1]
entity Resolv--><rect fill="#FEFECE" filter="url(#fyc6o7633s18l)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="86" x="535" y="351"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="601" y="356"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="599" y="358"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="599" y="362"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="550" y="383.9951">Resolv</text><!--MD5=[3a0ff2b2643b72e8f44f95515b106142]
entity Recon--><rect fill="#FEFECE" filter="url(#fyc6o7633s18l)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="85" x="32.5" y="199"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="97.5" y="204"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="95.5" y="206"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="95.5" y="210"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="47.5" y="231.9951">Recon</text><!--MD5=[7e52523184f1c3752292ac9e82232dbb]
entity LBD--><ellipse cx="549" cy="222" fill="#FEFECE" filter="url(#fyc6o7633s18l)" rx="8" ry="8" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="535" y="251.9951">LBD</text><!--MD5=[6aca76539caedc818cba8c9b47739e40]
entity CNCP--><rect fill="#FEFECE" filter="url(#fyc6o7633s18l)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="79" x="407.5" y="199"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="466.5" y="204"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="464.5" y="206"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="464.5" y="210"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="422.5" y="231.9951">CNCP</text><!--MD5=[fd9cb3b1ea3e9ece689fdeecdf204087]
entity htbt_main_ctx--><rect fill="#FEFECE" filter="url(#fyc6o7633s18l)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="104" x="611" y="199"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="695" y="204"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="693" y="206"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="693" y="210"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="626" y="231.9951">Main CTX</text><!--MD5=[7f924e49bd00f3f976a57574cd3bc1f6]
entity instance--><rect fill="#FEFECE" filter="url(#fyc6o7633s18l)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="99" x="260.5" y="351"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="339.5" y="356"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="337.5" y="358"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="337.5" y="362"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="275.5" y="383.9951">instance</text><!--MD5=[ffedf6a9cdd7339fb62ff841799d1be5]
entity cnc_txt_rec--><rect fill="#FEFECE" filter="url(#fyc6o7633s18l)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="134" x="795" y="351"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="909" y="356"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="907" y="358"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="907" y="362"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="810" y="383.9951">CNC TXT REC</text><ellipse cx="886.9744" cy="221.8949" fill="#FEFECE" filter="url(#fyc6o7633s18l)" rx="87.4744" ry="19.8949" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="818.9744" y="224.7416">Heartbeat Auth Impl</text><ellipse cx="439.1177" cy="29.1235" fill="#FEFECE" filter="url(#fyc6o7633s18l)" rx="103.6177" ry="23.1235" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="353.1177" y="31.9702">Another Proone Instance</text><ellipse cx="659.8658" cy="28.7732" fill="#FEFECE" filter="url(#fyc6o7633s18l)" rx="81.8658" ry="18.7732" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="597.3805" y="31.9463">Maintenance Tool</text><!--MD5=[667e7cdd0f777c530ea2dba1c08bd7e6]
entity victim_host--><polygon fill="#FEFECE" filter="url(#fyc6o7633s18l)" points="251.5,510,261.5,500,368.5,500,368.5,536.2969,358.5,546.2969,251.5,546.2969,251.5,510" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="358.5" x2="368.5" y1="510" y2="500"/><line style="stroke:#000000;stroke-width:1.5;" x1="251.5" x2="358.5" y1="510" y2="510"/><line style="stroke:#000000;stroke-width:1.5;" x1="358.5" x2="358.5" y1="510" y2="546.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="266.5" y="532.9951">Victim Host</text><!--MD5=[b7e637a441f953ebc24ed8fcb824f79f]
link CNCP to Resolv--><path d="M469.62,248.9 C493.56,276.31 531.12,319.32 555.15,346.83 " fill="none" id="CNCP-Resolv" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="558.59,350.78,555.694,341.3665,555.3056,347.01,549.6621,346.6216,558.59,350.78" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="466.33,245.13,469.226,254.5435,469.6144,248.9,475.2579,249.2884,466.33,245.13" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="514" y="296.0669">Queue TXT REC Query</text><!--MD5=[511425dc7163de3665735b7e68d9281b]
link Recon to Main Thread--><path d="M117.56,222 C152.24,222 201.88,222 242.05,222 " fill="none" id="Recon-to-Main Thread" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="247.4,222,238.4,218,242.4,222,238.4,226,247.4,222" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="136" y="215.0669">Event Callback</text><!--MD5=[ea78f22d1962f82ee76cb2026da67b81]
link Main Thread to instance--><path d="M310,245.13 C310,271.83 310,316.71 310,345.58 " fill="none" id="Main Thread-to-instance" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="310,350.78,314,341.78,310,345.78,306,341.78,310,350.78" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="311" y="296.0669">Spawn</text><!--MD5=[88cfced2f7268004fb8d4acb0a772cb6]
link htbt_main_ctx to htbt_auth_impl--><path d="M715.24,222 C738.72,222 767.17,222 794.1,222 " fill="none" id="htbt_main_ctx-to-htbt_auth_impl" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="799.11,222,790.11,218,794.11,222,790.11,226,799.11,222" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="733.25" y="215.0669">SOLICIT</text><!--MD5=[5d75f5d7b42a2ea2002a94bc95486ae0]
link cnc_txt_rec to Resolv--><path d="M789.69,374 C738.48,374 671.21,374 626.38,374 " fill="none" id="cnc_txt_rec-Resolv" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="621.13,374,630.13,378,626.13,374,630.13,370,621.13,374" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="794.9,374,785.9,370,789.9,374,785.9,378,794.9,374" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="661.5" y="367.0669">Query TXT REC</text><!--MD5=[21f13ee85425df7d0d44b20dfd58b782]
link a_prne_i to LBD--><path d="M460.72,51.76 C474.47,66.42 491.89,86.73 504,107 C524.32,141.02 538.89,185.87 545.32,207.79 " fill="none" id="a_prne_i-to-LBD" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="546.78,212.85,548.1345,203.0947,545.397,208.0451,540.4466,205.3076,546.78,212.85" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="500" y="95.0669">M2M</text><!--MD5=[32a84a1616dbc00c539143c912f55bdc]
link mttool to LBD--><path d="M641.51,47.56 C626.81,62.31 606.53,84.54 593,107 C572.61,140.84 558.6,185.77 552.48,207.75 " fill="none" id="mttool-to-LBD" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="551.1,212.82,557.329,205.1912,552.4168,207.9965,549.6114,203.0843,551.1,212.82" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="610" y="95.0669">Maintenance Access</text><!--MD5=[83cdfa74e954ec923cdff4b0977a496e]
link instance to victim_host--><path d="M310,397.01 C310,423.1 310,466.58 310,494.76 " fill="none" id="instance-to-victim_host" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="310,499.84,314,490.84,310,494.84,306,490.84,310,499.84" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="311" y="466.0669">Infect</text><!--MD5=[96da60eb07ff64def7a1d9d5675bf6cf]
@startuml proone
package "Proone Instance" as prne_i {
	[Main Thread]
	component Heartbeat {
		interface LBD
		component CNCP
		component "Main CTX" as htbt_main_ctx
	}
	component Resolv
	component Recon
	component "BNE Pool" as bne_pool {
		[instance]
	}

	[CNCP] <-d-> [Resolv]: Queue TXT REC Query
	[Recon] -> [Main Thread]: Event Callback
	[Main Thread] -d-> [instance]: Spawn
}

cloud "Public DOT Nameservers" {
	component "CNC TXT REC" as cnc_txt_rec
}

usecase "Heartbeat Auth Impl" as htbt_auth_impl
usecase "Another Proone Instance" as a_prne_i
usecase "Maintenance Tool" as mttool
node "Victim Host" as victim_host

[htbt_main_ctx] -> [htbt_auth_impl]: SOLICIT
[cnc_txt_rec] <-> [Resolv]: Query TXT REC
a_prne_i -d-> (LBD): M2M
mttool -d-> (LBD): Maintenance Access
[instance] -d-> victim_host: Infect
@enduml

PlantUML version 1.2021.7(Sun May 23 20:40:07 AWST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>